

Do's and Don'ts
---------------
- Don't forget to mark any new classes with the [ComVisible(false)]
  - otherwise entries are created in the registry

- Do start Visual Studio with Admin privileges. That way, you can register/unregister the add in directly
  - Right-click the Visual Studio 2010 icon and click Run as Administrator.
	- You can then right-click the Docear4Word project and choose Register ADX Project and Unregister ADX Project

- Don't worry if a registration/unregistration fails - file in user or some other thing. Just restart VS2010 and it will work. 
  (I've given up trying to find solutions to this)



Generating an installer for a new version
-----------------------------------------
- Ensure that the Assembly Version is updated. (Properties\AssemblyInfo - look for Assembly Version)

- Set the Output File name to match:
	- Right-click on the Docear4WordSetup project and choose Properties
	- Set the correct value in the "Output file name" field
- Update the Setup project version:
  - Click on the Docear4WordSetup project
  - Press F4 to show Properties
	- Change the version property
	- When you get this message: "It is recommended that the ProductCode be changed if you change the version. Do you want to do this?"
	  CLICK YES!!!! (otherwise any existing installation on a user's PC is not updated)

- Create the installer
	- Right-click on the Docear4WordSetup project and choose Build
	- The application will be compiled and produce output something like this:

				------ Build started: Project: JavaScriptIntegration, Configuration: Debug Any CPU ------
					JavaScriptIntegration -> F:\src\Visual Studio 2010\Projects\Docear4Word\JavaScriptIntegration\bin\Debug\JavaScriptIntegration.dll
				------ Build started: Project: Docear4Word, Configuration: Debug Any CPU ------
				F:\src\Visual Studio 2010\Projects\Docear4Word\docear4word\MainController.cs(80,4): warning CS0162: Unreachable code detected

				Compile complete -- 0 errors, 1 warnings
					Docear4Word -> F:\src\Visual Studio 2010\Projects\Docear4Word\docear4word\bin\Debug\Docear4Word.dll
				------ Starting pre-build validation for project 'Docear4WordSetup [Default]' ------ 
				------ Pre-build validation for project 'Docear4WordSetup [Default]' completed ------
				------ Build started: Project: Docear4WordSetup [Default], Configuration: Debug ------
				Building file 'F:\src\Visual Studio 2010\Projects\Docear4Word\docear4wordSetup\0.9.0\Debug\Docear4WordSetup(0.9.8).msi'...
				WARNING: File 'adxloader64.dll' targeting 'x64' is not compatible with the project's target platform 'x86'
				Packaging file 'acs-chemical-biology.csl'...
				Packaging file 'adxloader64.dll'...
				Packaging file 'mla-url.csl'...
				Packaging file 'Sys.js'...
				Packaging file 'advanced-engineering-materials.csl'...
				Packaging file 'adxregistrator.exe'...
				Packaging file 'xmldom.js'...
				Packaging file 'JSON.js'...
				Packaging file 'acm-sig-proceedings.csl'...
				Packaging file 'Interop.VBIDE.dll'...
				Packaging file 'eco.csl'...
				Packaging file 'turabian-fullnote-bibliography.csl'...
				Packaging file 'ieee.csl'...
				Packaging file 'apa5th.csl'...
				Packaging file 'citeproc.js'...
				Packaging file 'Interop.Office.dll'...
				Packaging file 'harvard1.csl'...
				Packaging file 'JSRunner.js'...
				Packaging file 'vancouver.csl'...
				Packaging file 'ieee - margin.csl'...
				Packaging file 'adxloader.dll.manifest'...
				Packaging file 'Interop.Word.dll'...
				Packaging file 'AddinExpress.MSO.2005.dll'...
				Packaging file 'elsevier-harvard.csl'...
				Packaging file 'apa.csl'...
				Packaging file 'turabian-author-date.csl'...
				Packaging file 'Docear4Word.dll'...
				Packaging file 'mla.csl'...
				Packaging file 'ieee-w-url.csl'...
				Packaging file 'adxloader.dll'...
				Packaging file 'JavaScriptIntegration.dll'...
				Packaging file 'chicago-annotated-bibliography.csl'...
				Packaging file 'nature.csl'...
				Packaging file 'mla-notes.csl'...
				Packaging file 'acm-sig-proceedings-long-author-list.csl'...
				Packaging file 'Extensibility.dll'...
				Starting post-build events...
				Disable AllUsers Group action: The AllUsers group will not be shown in the 'Installation Folder' dialog.

				Impersonation action: The 'adxregistrator.exe' custom action will be run with the invoker's privileges.

				Post-build events finished
				========== Build: 3 succeeded or up-to-date, 0 failed, 0 skipped ==========





  